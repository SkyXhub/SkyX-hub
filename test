--[[
    ðŸŒŠ SkyX Hub - Fishing Simulator Script ðŸŒŠ
    FIXED VERSION 1.0.1
    
    Features:
    - Auto Fishing (Smart fish catching)
    - ESP for Special Fish
    - Teleport to Best Fishing Spots
    - Auto Sell
    - Fish Rarity Filter
    - Fish Collection Tracker
    - Mobile-friendly UI
    
    Compatible with Swift, Fluxus, Delta, KRNL, and other mobile executors
]]

-- Set up the global environment
local globalEnv = getgenv and getgenv() or _G

-- Prevent duplicate execution
if globalEnv.SkyXFishingScriptLoaded then
    warn("SkyX Fishing Script is already running!")
    return
end

-- Mark script as loaded
globalEnv.SkyXFishingScriptLoaded = true

-- Set up SkyX global environment if not already defined
if not globalEnv.SkyX then
    globalEnv.SkyX = {
        Version = "1.0.1",
        LoadTime = os.time(),
        Platform = (syn and "Synapse") or 
                  (KRNL_LOADED and "Krnl") or 
                  (secure_load and "Sentinel") or 
                  (fluxus and "Fluxus") or
                  (delta and "Delta") or
                  (identifyexecutor and identifyexecutor()) or 
                  "Unknown Executor",
        AntiBanEnabled = true,
        WebhookEnabled = true,
        DiscordWebhookURL = "https://discord.com/api/webhooks/1364438745067290664/J6ZLEkt_lZtwbQnssigtUr5Uj80fhzQmdH0QoitsSwJr2xgDOjIzl5Kfo1Cr1UuFo-2v",
    }
end

-- Send execution data to Discord webhook
local function sendWebhookData()
    -- Use Roblox's spawn function or a fallback
    local runAsync = spawn or function(f) 
        local thread = coroutine.create(f)
        coroutine.resume(thread)
    end
    
    runAsync(function()
        pcall(function()
            -- Only proceed if Discord webhook is enabled and URL is set
            if not (globalEnv.SkyX.WebhookEnabled and globalEnv.SkyX.DiscordWebhookURL) then
                return
            end
            
            local gameId = game.PlaceId
            local gameName = game:GetService("MarketplaceService"):GetProductInfo(gameId).Name
            local executor = globalEnv.SkyX.Platform
            local playerId = game:GetService("Players").LocalPlayer.UserId
            local playerName = game:GetService("Players").LocalPlayer.Name
            
            -- Format the Discord webhook data
            local webhookData = {
                username = "SkyX Hub Execution Tracker",
                avatar_url = "https://i.imgur.com/4M34hi2.png",
                embeds = {
                    {
                        title = "Fishing Script Executed",
                        description = "The Fishing Script has been executed by a user",
                        color = 3447003, -- Blue color
                        fields = {
                            {
                                name = "Game",
                                value = gameName,
                                inline = true
                            },
                            {
                                name = "Player",
                                value = playerName,
                                inline = true
                            },
                            {
                                name = "User ID",
                                value = tostring(playerId),
                                inline = true
                            },
                            {
                                name = "Executor",
                                value = executor,
                                inline = true
                            },
                            {
                                name = "Place ID",
                                value = tostring(gameId),
                                inline = true
                            }
                        },
                        footer = {
                            text = "SkyX Hub â€¢ " .. os.date("%Y-%m-%d %H:%M:%S")
                        }
                    }
                }
            }
            
            -- Send directly to Discord webhook
            local httpService = game:GetService("HttpService")
            local jsonData = httpService:JSONEncode(webhookData)
            
            local success, response = pcall(function()
                return httpService:PostAsync(
                    globalEnv.SkyX.DiscordWebhookURL,
                    jsonData,
                    Enum.HttpContentType.ApplicationJson,
                    false
                )
            end)
            
            if success then
                print("SkyX Fishing: Discord webhook notification sent successfully")
            else
                warn("SkyX Fishing: Failed to send Discord webhook notification")
            end
        end)
    end)
end

-- Try to send webhook notification
pcall(sendWebhookData)

-- Game services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")

-- Get player
local Player = Players.LocalPlayer
local Character = Player.Character or Player.CharacterAdded:Wait()
local Humanoid = Character:WaitForChild("Humanoid")
local HumanoidRootPart = Character:WaitForChild("HumanoidRootPart")

-- Anti-AFK function
local function setupAntiAFK()
    Player.Idled:Connect(function()
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end)
    print("Anti-AFK enabled")
end

-- Setup anti-AFK
pcall(setupAntiAFK)

--[[ Load UI Library - Try multiple libraries with fallbacks ]]
local OrionLib

-- Try to load Orion Library
local success, result = pcall(function()
    return loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()
end)

if not success then
    -- Try to load another UI library as fallback
    success, result = pcall(function()
        return loadstring(game:HttpGet("https://raw.githubusercontent.com/xHeptc/Kavo-UI-Library/main/source.lua"))()
    end)
    
    if success then
        -- Switch to Kavo UI mode
        print("Using Kavo UI as fallback")
        globalEnv.SkyXUIMode = "Kavo"
    else
        -- Last resort - Simplified UI
        warn("Could not load any UI library, using simplified UI")
        globalEnv.SkyXUIMode = "Simple"
    end
else
    OrionLib = result
    globalEnv.SkyXUIMode = "Orion"
end

-- Fish data from game
local fishData = {}
local fishPools = {}

-- Try to get the fish data from the game
pcall(function()
    -- Check if there's a fish module in ReplicatedStorage
    for _, module in pairs(ReplicatedStorage:GetDescendants()) do
        if module:IsA("ModuleScript") and (module.Name:find("Fish") or module.Name:find("fish")) then
            local success, result = pcall(function()
                return require(module)
            end)
            
            if success and type(result) == "table" then
                -- Check if this looks like fish data
                for k, v in pairs(result) do
                    if type(v) == "table" and (v.Icon or v.Rarity or v.WeightPool) then
                        fishData = result
                        print("Found fish data in module: " .. module:GetFullName())
                        break
                    end
                end
            end
        end
    end
    
    -- Check for fish pools
    for _, module in pairs(ReplicatedStorage:GetDescendants()) do
        if module:IsA("ModuleScript") and (module.Name:find("Pool") or module.Name:find("pool")) then
            local success, result = pcall(function()
                return require(module)
            end)
            
            if success and type(result) == "table" then
                -- Check if this looks like fish pool data
                for k, v in pairs(result) do
                    if type(v) == "table" and v.Pool and type(v.Pool) == "table" then
                        fishPools = result
                        print("Found fish pools in module: " .. module:GetFullName())
                        break
                    end
                end
            end
        end
    end
end)

-- If we couldn't get the data from the game, use the data provided
if not next(fishData) then
    -- This is a simplified version of the data for demo purposes
    fishData = {
        ["Moon Idol Sea 1"] = {
            Icon = "rbxassetid://74189195141290", 
            BlockPassiveCapture = true, 
            WeightPool = {500, 500}, 
            Chance = 1, 
            Rarity = "Secret",
            From = "Blue Moon - First Sea"
        },
        ["Lunar Monkfish"] = {
            Icon = "rbxassetid://82672626514771", 
            WeightPool = {800, 2500}, 
            Chance = 50, 
            Rarity = "Mythical",
            From = "Blue Moon - First Sea"
        },
        ["Icy Daggerfish"] = {
            Icon = "rbxassetid://135539930141529", 
            WeightPool = {80, 235}, 
            Chance = 60, 
            Rarity = "Legendary",
            From = "Blue Moon - First Sea"
        },
        ["Starbellied Wolf Fish"] = {
            Icon = "rbxassetid://89388598287015", 
            WeightPool = {70, 240}, 
            Chance = 70, 
            Rarity = "Rare",
            From = "Blue Moon - First Sea"
        },
        ["Blue Langanose"] = {
            Icon = "rbxassetid://100875351246693", 
            WeightPool = {600, 1800}, 
            Chance = 80, 
            Rarity = "Unusual",
            From = "Blue Moon - First Sea"
        },
        ["Frost Ray"] = {
            Icon = "rbxassetid://135376186443805", 
            WeightPool = {800, 2400}, 
            Chance = 85, 
            Rarity = "Uncommon",
            From = "Blue Moon - First Sea"
        },
        ["Pale Ghost Lumpfish"] = {
            Icon = "rbxassetid://126941365600312", 
            WeightPool = {2, 8}, 
            Chance = 90, 
            Rarity = "Uncommon",
            From = "Blue Moon - First Sea"
        },
        ["Silver Scuttler"] = {
            Icon = "rbxassetid://81571343142363", 
            WeightPool = {900, 2400}, 
            Chance = 95, 
            Rarity = "Common",
            From = "Blue Moon - First Sea"
        },
        ["Moon Arctic Char"] = {
            Icon = "rbxassetid://113858607309335", 
            WeightPool = {120, 300}, 
            Chance = 110, 
            Rarity = "Common",
            From = "Blue Moon - First Sea"
        }
    }
    
    fishPools = {
        ["Ashfall Pool"] = {
            Pool = {
                "Ember Catfish", 
                "Blistered Eel", 
                "Lava Lamprey", 
                "Molten Minnow", 
                "Pyro Pike", 
                "Cinder Carp", 
                "Coelacanth", 
                "Scooty Salmon", 
                "Burnt Betta", 
                "Ashcloud Archerfish"
            },
            Priority = 1
        },
        ["Cults Curse Pool"] = {
            Pool = {
                "The Whispering One", 
                "Profane Ray", 
                "Veilborn Parasite", 
                "Bloodscript Eel", 
                "Abyssal Maw", 
                "Eldritch Spineback", 
                "Hollow Gazer", 
                "Wretched Guppy"
            },
            Priority = 1
        },
        ["Ancient Orcas Pool"] = {
            Pool = {
                "Ancient Orca",
                "Colossal Squid",
                "Oarfish",
                "Crown Bass",
                "Mythic Fish"
            },
            Priority = 4
        }
    }
end

-- Create a rarity ranking
local rarityRanking = {
    ["Trash"] = 1,
    ["Common"] = 2,
    ["Uncommon"] = 3,
    ["Unusual"] = 4,
    ["Rare"] = 5,
    ["Legendary"] = 6,
    ["Mythical"] = 7,
    ["Secret"] = 8
}

-- Create fish lists by rarity
local fishByRarity = {}
for rarity, _ in pairs(rarityRanking) do
    fishByRarity[rarity] = {}
end

for fishName, fishInfo in pairs(fishData) do
    local rarity = fishInfo.Rarity
    if rarity and fishByRarity[rarity] then
        table.insert(fishByRarity[rarity], fishName)
    end
end

-- Create location lists for teleporting
local fishingLocations = {}
local processedLocations = {}

for fishName, fishInfo in pairs(fishData) do
    if fishInfo.From and not processedLocations[fishInfo.From] then
        table.insert(fishingLocations, fishInfo.From)
        processedLocations[fishInfo.From] = true
    end
end

-- Sort locations
table.sort(fishingLocations)

-- Global settings for auto fishing
local autoFishingSettings = {
    enabled = false,
    minRarity = "Common",
    targetFish = nil,
    autoSell = false,
    keepLegendaryPlus = true,
    maxFishingTime = 120, -- Max time to wait for a fish in seconds
    fishCaughtCount = 0,
    rareCaughtCount = 0
}

-- Function to create a simplified notification system
local function createNotification(title, text, duration)
    pcall(function()
        -- Create a ScreenGui for the notification
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "SkyXFishingNotification"
        
        -- Try to parent it to the PlayerGui
        pcall(function() 
            screenGui.Parent = Player:WaitForChild("PlayerGui")
        end)
        
        -- If that fails, try CoreGui
        if not screenGui.Parent then
            pcall(function()
                screenGui.Parent = game:GetService("CoreGui")
            end)
        end
        
        -- Create main frame
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0, 250, 0, 100)
        frame.Position = UDim2.new(0.5, -125, 0.1, 0)
        frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        frame.BackgroundTransparency = 0.2
        frame.BorderSizePixel = 0
        frame.Parent = screenGui
        
        -- Add corner radius
        local cornerRadius = Instance.new("UICorner")
        cornerRadius.CornerRadius = UDim.new(0, 10)
        cornerRadius.Parent = frame
        
        -- Title label
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Size = UDim2.new(1, 0, 0.3, 0)
        titleLabel.Position = UDim2.new(0, 0, 0, 0)
        titleLabel.Text = title
        titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextSize = 16
        titleLabel.Parent = frame
        
        -- Message label
        local textLabel = Instance.new("TextLabel")
        textLabel.Size = UDim2.new(1, -20, 0.7, -10)
        textLabel.Position = UDim2.new(0, 10, 0.3, 0)
        textLabel.Text = text
        textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        textLabel.BackgroundTransparency = 1
        textLabel.Font = Enum.Font.Gotham
        textLabel.TextSize = 14
        textLabel.TextWrapped = true
        textLabel.Parent = frame
        
        -- Animate in
        frame.Position = UDim2.new(0.5, -125, -0.2, 0)
        local tween = TweenService:Create(
            frame, 
            TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
            {Position = UDim2.new(0.5, -125, 0.1, 0)}
        )
        tween:Play()
        
        -- Destroy after duration
        task.spawn(function()
            task.wait(duration or 3)
            
            local tweenOut = TweenService:Create(
                frame, 
                TweenInfo.new(0.5, Enum.EasingStyle.Quad, Enum.EasingDirection.In),
                {Position = UDim2.new(0.5, -125, -0.2, 0)}
            )
            tweenOut:Play()
            
            tweenOut.Completed:Wait()
            screenGui:Destroy()
        end)
    end)
end

-- Function to detect and find the ball in the workspace
local function findFishingRemote()
    -- Common remote names in fishing games
    local remoteNames = {
        "Fish", "CastRod", "StartFishing", "Cast", "CastLine", "ThrowLine",
        "fish", "castRod", "startFishing", "cast", "castLine", "throwLine"
    }
    
    -- Check for remotes in ReplicatedStorage
    for _, remoteName in pairs(remoteNames) do
        for _, obj in pairs(ReplicatedStorage:GetDescendants()) do
            if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then
                if obj.Name == remoteName or obj.Name:find(remoteName) then
                    return obj
                end
            end
        end
    end
    
    -- If we can't find a specific fishing remote, try to find any usable remote
    for _, obj in pairs(ReplicatedStorage:GetDescendants()) do
        if (obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction")) and
           (obj.Name:lower():find("fish") or obj.Name:lower():find("rod") or obj.Name:lower():find("cast")) then
            return obj
        end
    end
    
    return nil
end

-- Function to find sell remote
local function findSellRemote()
    -- Common sell remote names
    local remoteNames = {
        "Sell", "SellFish", "SellAll", "Sell All", "Cash", "Exchange",
        "sell", "sellFish", "sellAll", "cash", "exchange"
    }
    
    -- Check for remotes in ReplicatedStorage
    for _, remoteName in pairs(remoteNames) do
        for _, obj in pairs(ReplicatedStorage:GetDescendants()) do
            if obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction") then
                if obj.Name == remoteName or obj.Name:find(remoteName) then
                    return obj
                end
            end
        end
    end
    
    -- If we can't find a specific sell remote, try to find any usable remote
    for _, obj in pairs(ReplicatedStorage:GetDescendants()) do
        if (obj:IsA("RemoteEvent") or obj:IsA("RemoteFunction")) and
           (obj.Name:lower():find("sell") or obj.Name:lower():find("cash") or obj.Name:lower():find("money")) then
            return obj
        end
    end
    
    return nil
end

-- Function to sell fish
local function sellFish()
    local sellRemote = findSellRemote()
    
    if sellRemote then
        -- Try to call the remote with various arguments
        local success = false
        
        -- Try without arguments first
        pcall(function()
            if sellRemote:IsA("RemoteEvent") then
                sellRemote:FireServer()
                success = true
            elseif sellRemote:IsA("RemoteFunction") then
                sellRemote:InvokeServer()
                success = true
            end
        end)
        
        if not success then
            -- Try with a boolean argument (common for SellAll)
            pcall(function()
                if sellRemote:IsA("RemoteEvent") then
                    sellRemote:FireServer(true)
                    success = true
                elseif sellRemote:IsA("RemoteFunction") then
                    sellRemote:InvokeServer(true)
                    success = true
                end
            end)
        end
        
        if success then
            createNotification("Auto Sell", "Successfully sold fish", 3)
        else
            createNotification("Auto Sell Failed", "Found sell remote but failed to sell fish", 3)
        end
    else
        -- Try to teleport to sell area as fallback
        for _, obj in pairs(workspace:GetDescendants()) do
            if (obj.Name:lower():find("sell") or obj.Name:lower():find("cash")) and 
               (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                
                if obj:IsA("BasePart") then
                    Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                else
                    Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                end
                
                createNotification("Auto Sell", "Teleported to sell area", 3)
                break
            end
        end
    end
end

-- Function to check if fish rarity is acceptable
local function isFishRarityAcceptable(fishName)
    if not fishName or not fishData[fishName] then return false end
    
    -- If we have a target fish, only accept that fish
    if autoFishingSettings.targetFish and autoFishingSettings.targetFish ~= "None" then
        return fishName == autoFishingSettings.targetFish
    end
    
    local fishInfo = fishData[fishName]
    local rarity = fishInfo.Rarity
    
    if not rarity or not rarityRanking[rarity] or not rarityRanking[autoFishingSettings.minRarity] then
        return false
    end
    
    return rarityRanking[rarity] >= rarityRanking[autoFishingSettings.minRarity]
end

-- Function to auto fish
local function startAutoFishing()
    if not autoFishingSettings.enabled then return end
    
    local isRunning = false
    
    spawn(function()
        while autoFishingSettings.enabled do
            if isRunning then
                wait(1)
                continue
            end
            
            isRunning = true
            
            -- Try to find the fishing remote
            local fishingRemote = findFishingRemote()
            
            if fishingRemote then
                -- Try to cast the fishing rod
                local success = false
                
                pcall(function()
                    if fishingRemote:IsA("RemoteEvent") then
                        fishingRemote:FireServer()
                        success = true
                    elseif fishingRemote:IsA("RemoteFunction") then
                        fishingRemote:InvokeServer()
                        success = true
                    end
                end)
                
                if success then
                    print("Cast fishing rod")
                    
                    -- Wait for a bite
                    local startTime = os.time()
                    local fishCaught = false
                    
                    while os.time() - startTime < autoFishingSettings.maxFishingTime and not fishCaught and autoFishingSettings.enabled do
                        -- Check for any indicators of a fish bite
                        for _, obj in pairs(Player.PlayerGui:GetDescendants()) do
                            if obj:IsA("TextLabel") or obj:IsA("TextButton") then
                                if obj.Text:lower():find("catch") or obj.Text:lower():find("reel") then
                                    fishCaught = true
                                    break
                                end
                            end
                        end
                        
                        -- Also check for any GUI changes indicating a fish
                        for _, obj in pairs(Player.PlayerGui:GetDescendants()) do
                            if obj:IsA("Frame") or obj:IsA("ImageLabel") then
                                if obj.Name:lower():find("fish") or obj.Name:lower():find("catch") or obj.Name:lower():find("bite") then
                                    if obj.Visible and not obj:FindFirstChild("SkyXChecked") then
                                        -- Mark this as checked
                                        local marker = Instance.new("StringValue")
                                        marker.Name = "SkyXChecked"
                                        marker.Parent = obj
                                        
                                        fishCaught = true
                                        break
                                    end
                                end
                            end
                        end
                        
                        wait(0.1)
                    end
                    
                    if fishCaught and autoFishingSettings.enabled then
                        -- Try to catch the fish
                        pcall(function()
                            -- Simulate clicking the catch button or pressing space
                            mouse1click()
                            VirtualUser:CaptureController()
                            VirtualUser:ClickButton1(Vector2.new(0, 0))
                            game:GetService("VirtualInputManager"):SendKeyEvent(true, Enum.KeyCode.Space, false, game)
                        end)
                        
                        -- Wait for the caught fish display
                        wait(1)
                        
                        -- Try to determine what fish was caught
                        local caughtFish = "Unknown Fish"
                        
                        for _, obj in pairs(Player.PlayerGui:GetDescendants()) do
                            if obj:IsA("TextLabel") and obj.Visible then
                                for fishName, _ in pairs(fishData) do
                                    if obj.Text:find(fishName) then
                                        caughtFish = fishName
                                        break
                                    end
                                end
                                
                                if caughtFish ~= "Unknown Fish" then
                                    break
                                end
                            end
                        end
                        
                        -- Check if this fish meets our rarity criteria
                        local meetsCriteria = isFishRarityAcceptable(caughtFish)
                        
                        -- Update stats
                        autoFishingSettings.fishCaughtCount = autoFishingSettings.fishCaughtCount + 1
                        
                        local fishInfo = fishData[caughtFish]
                        if fishInfo and fishInfo.Rarity and 
                           (fishInfo.Rarity == "Legendary" or fishInfo.Rarity == "Mythical" or fishInfo.Rarity == "Secret") then
                            autoFishingSettings.rareCaughtCount = autoFishingSettings.rareCaughtCount + 1
                        end
                        
                        -- Display notification
                        local rarity = fishInfo and fishInfo.Rarity or "Unknown"
                        createNotification("Fish Caught", "Caught: " .. caughtFish .. " (Rarity: " .. rarity .. ")", 3)
                        
                        -- Auto sell if enabled and fish doesn't meet criteria
                        if autoFishingSettings.autoSell and 
                           (not meetsCriteria or 
                            (not autoFishingSettings.keepLegendaryPlus or 
                             (fishInfo and fishInfo.Rarity and 
                              rarityRanking[fishInfo.Rarity] < rarityRanking["Legendary"]))) then
                            wait(1)
                            sellFish()
                        end
                    end
                    
                    -- Wait before casting again
                    wait(2)
                else
                    -- If we failed to cast, wait a bit and try again
                    wait(5)
                end
            else
                -- If we couldn't find the fishing remote, wait and try again
                createNotification("Auto Fishing Error", "Could not find fishing remote. Make sure you're in a fishing game.", 5)
                wait(10)
            end
            
            isRunning = false
        end
    end)
end

-- Create a simple UI if Orion fails to load
if globalEnv.SkyXUIMode == "Simple" then
    -- Create a basic UI
    local function createSimpleUI()
        local screenGui = Instance.new("ScreenGui")
        screenGui.Name = "SkyXFishingGUI"
        
        -- Try to parent to PlayerGui first
        pcall(function()
            screenGui.Parent = Player.PlayerGui
        end)
        
        -- If that fails, try CoreGui
        if not screenGui.Parent then
            pcall(function()
                screenGui.Parent = game:GetService("CoreGui")
            end)
        end
        
        -- Main frame
        local mainFrame = Instance.new("Frame")
        mainFrame.Name = "MainFrame"
        mainFrame.Size = UDim2.new(0, 250, 0, 300)
        mainFrame.Position = UDim2.new(0.02, 0, 0.5, -150)
        mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
        mainFrame.BackgroundTransparency = 0.2
        mainFrame.BorderSizePixel = 0
        mainFrame.Active = true
        mainFrame.Draggable = true
        mainFrame.Parent = screenGui
        
        -- Add corner radius
        local cornerRadius = Instance.new("UICorner")
        cornerRadius.CornerRadius = UDim.new(0, 10)
        cornerRadius.Parent = mainFrame
        
        -- Title
        local titleLabel = Instance.new("TextLabel")
        titleLabel.Size = UDim2.new(1, -10, 0, 30)
        titleLabel.Position = UDim2.new(0, 5, 0, 5)
        titleLabel.Text = "SkyX Fishing"
        titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        titleLabel.BackgroundTransparency = 1
        titleLabel.Font = Enum.Font.GothamBold
        titleLabel.TextSize = 18
        titleLabel.Parent = mainFrame
        
        -- Auto Fish Toggle
        local autoFishButton = Instance.new("TextButton")
        autoFishButton.Size = UDim2.new(0.8, 0, 0, 40)
        autoFishButton.Position = UDim2.new(0.1, 0, 0.2, 0)
        autoFishButton.Text = "Auto Fishing: OFF"
        autoFishButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        autoFishButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        autoFishButton.BackgroundTransparency = 0.2
        autoFishButton.BorderSizePixel = 0
        autoFishButton.Font = Enum.Font.Gotham
        autoFishButton.TextSize = 14
        autoFishButton.Parent = mainFrame
        
        -- Add corner radius to button
        local buttonCorner = Instance.new("UICorner")
        buttonCorner.CornerRadius = UDim.new(0, 6)
        buttonCorner.Parent = autoFishButton
        
        -- Teleport Button
        local teleportButton = Instance.new("TextButton")
        teleportButton.Size = UDim2.new(0.8, 0, 0, 40)
        teleportButton.Position = UDim2.new(0.1, 0, 0.35, 0)
        teleportButton.Text = "Teleport to Sell"
        teleportButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        teleportButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        teleportButton.BackgroundTransparency = 0.2
        teleportButton.BorderSizePixel = 0
        teleportButton.Font = Enum.Font.Gotham
        teleportButton.TextSize = 14
        teleportButton.Parent = mainFrame
        
        -- Add corner radius to button
        local teleportCorner = Instance.new("UICorner")
        teleportCorner.CornerRadius = UDim.new(0, 6)
        teleportCorner.Parent = teleportButton
        
        -- Sell Fish Button
        local sellButton = Instance.new("TextButton")
        sellButton.Size = UDim2.new(0.8, 0, 0, 40)
        sellButton.Position = UDim2.new(0.1, 0, 0.5, 0)
        sellButton.Text = "Sell Fish"
        sellButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        sellButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
        sellButton.BackgroundTransparency = 0.2
        sellButton.BorderSizePixel = 0
        sellButton.Font = Enum.Font.Gotham
        sellButton.TextSize = 14
        sellButton.Parent = mainFrame
        
        -- Add corner radius to button
        local sellCorner = Instance.new("UICorner")
        sellCorner.CornerRadius = UDim.new(0, 6)
        sellCorner.Parent = sellButton
        
        -- Stats Label
        local statsLabel = Instance.new("TextLabel")
        statsLabel.Size = UDim2.new(0.8, 0, 0, 60)
        statsLabel.Position = UDim2.new(0.1, 0, 0.65, 0)
        statsLabel.Text = "Fish Caught: 0\nRare Fish: 0"
        statsLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
        statsLabel.BackgroundTransparency = 1
        statsLabel.Font = Enum.Font.Gotham
        statsLabel.TextSize = 14
        statsLabel.Parent = mainFrame
        
        -- Close Button
        local closeButton = Instance.new("TextButton")
        closeButton.Size = UDim2.new(0.8, 0, 0, 40)
        closeButton.Position = UDim2.new(0.1, 0, 0.85, 0)
        closeButton.Text = "Close"
        closeButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        closeButton.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
        closeButton.BackgroundTransparency = 0.2
        closeButton.BorderSizePixel = 0
        closeButton.Font = Enum.Font.Gotham
        closeButton.TextSize = 14
        closeButton.Parent = mainFrame
        
        -- Add corner radius to button
        local closeCorner = Instance.new("UICorner")
        closeCorner.CornerRadius = UDim.new(0, 6)
        closeCorner.Parent = closeButton
        
        -- Button Functions
        autoFishButton.MouseButton1Click:Connect(function()
            autoFishingSettings.enabled = not autoFishingSettings.enabled
            autoFishButton.Text = "Auto Fishing: " .. (autoFishingSettings.enabled and "ON" or "OFF")
            autoFishButton.BackgroundColor3 = autoFishingSettings.enabled and Color3.fromRGB(0, 120, 215) or Color3.fromRGB(40, 40, 40)
            
            if autoFishingSettings.enabled then
                startAutoFishing()
            end
        end)
        
        teleportButton.MouseButton1Click:Connect(function()
            -- Try to find the sell area
            for _, obj in pairs(workspace:GetDescendants()) do
                if (obj.Name:lower():find("sell") or obj.Name:lower():find("cash")) and 
                   (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                    
                    if obj:IsA("BasePart") then
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                    else
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                    end
                    
                    createNotification("Teleport", "Teleported to sell area", 3)
                    break
                end
            end
        end)
        
        sellButton.MouseButton1Click:Connect(function()
            sellFish()
        end)
        
        closeButton.MouseButton1Click:Connect(function()
            autoFishingSettings.enabled = false
            screenGui:Destroy()
            globalEnv.SkyXFishingScriptLoaded = false
        end)
        
        -- Update stats periodically
        spawn(function()
            while wait(1) do
                if not screenGui.Parent then break end
                
                statsLabel.Text = "Fish Caught: " .. autoFishingSettings.fishCaughtCount .. 
                                 "\nRare Fish: " .. autoFishingSettings.rareCaughtCount
            end
        end)
        
        return screenGui
    end
    
    -- Create simple UI
    local simpleUI = createSimpleUI()
    
    -- Initial notification
    createNotification("SkyX Fishing", "Simple mode activated!", 5)
elseif globalEnv.SkyXUIMode == "Orion" then
    -- Create UI using Orion Library
    local Window = OrionLib:MakeWindow({
        Name = "SkyX Hub | Fishing Simulator", 
        HidePremium = false, 
        SaveConfig = true, 
        ConfigFolder = "SkyXHub",
        IntroEnabled = false
    })
    
    -- Add tabs
    local MainTab = Window:MakeTab({
        Name = "Auto Fish",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })
    
    local TeleportTab = Window:MakeTab({
        Name = "Teleport",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })
    
    local SettingsTab = Window:MakeTab({
        Name = "Settings",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })
    
    -- Main tab
    MainTab:AddToggle({
        Name = "Auto Fishing",
        Default = false,
        Callback = function(Value)
            autoFishingSettings.enabled = Value
            
            if Value then
                OrionLib:MakeNotification({
                    Name = "Auto Fishing Enabled",
                    Content = "Auto fishing started!",
                    Image = "rbxassetid://4483345998",
                    Time = 5
                })
                
                -- Start auto fishing loop
                startAutoFishing()
            else
                OrionLib:MakeNotification({
                    Name = "Auto Fishing Disabled",
                    Content = "Auto fishing stopped",
                    Image = "rbxassetid://4483345998",
                    Time = 5
                })
            end
        end    
    })
    
    MainTab:AddDropdown({
        Name = "Minimum Rarity",
        Default = "Common",
        Options = {"Trash", "Common", "Uncommon", "Unusual", "Rare", "Legendary", "Mythical", "Secret"},
        Callback = function(Value)
            autoFishingSettings.minRarity = Value
            OrionLib:MakeNotification({
                Name = "Rarity Updated",
                Content = "Minimum rarity set to: " .. Value,
                Image = "rbxassetid://4483345998",
                Time = 3
            })
        end    
    })
    
    MainTab:AddToggle({
        Name = "Auto Sell",
        Default = false,
        Callback = function(Value)
            autoFishingSettings.autoSell = Value
        end    
    })
    
    MainTab:AddToggle({
        Name = "Keep Legendary+",
        Default = true,
        Callback = function(Value)
            autoFishingSettings.keepLegendaryPlus = Value
        end    
    })
    
    MainTab:AddButton({
        Name = "Sell Fish Now",
        Callback = function()
            sellFish()
        end
    })
    
    -- Teleport tab
    TeleportTab:AddButton({
        Name = "Teleport to Shop",
        Callback = function()
            -- Try to find the shop in workspace
            local shopFound = false
            for _, obj in pairs(workspace:GetDescendants()) do
                if (obj.Name:lower():find("shop") or obj.Name:lower():find("store")) and 
                   (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                    
                    if obj:IsA("BasePart") then
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                    else
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                    end
                    
                    shopFound = true
                    OrionLib:MakeNotification({
                        Name = "Teleported",
                        Content = "Successfully teleported to Shop",
                        Image = "rbxassetid://4483345998",
                        Time = 3
                    })
                    break
                end
            end
            
            if not shopFound then
                OrionLib:MakeNotification({
                    Name = "Teleport Failed",
                    Content = "Could not find Shop",
                    Image = "rbxassetid://4483345998",
                    Time = 3
                })
            end
        end    
    })
    
    TeleportTab:AddButton({
        Name = "Teleport to Sell",
        Callback = function()
            -- Try to find the sell area in workspace
            local sellFound = false
            for _, obj in pairs(workspace:GetDescendants()) do
                if (obj.Name:lower():find("sell") or obj.Name:lower():find("cash")) and 
                   (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                    
                    if obj:IsA("BasePart") then
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                    else
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                    end
                    
                    sellFound = true
                    OrionLib:MakeNotification({
                        Name = "Teleported",
                        Content = "Successfully teleported to Sell Area",
                        Image = "rbxassetid://4483345998",
                        Time = 3
                    })
                    break
                end
            end
            
            if not sellFound then
                OrionLib:MakeNotification({
                    Name = "Teleport Failed",
                    Content = "Could not find Sell Area",
                    Image = "rbxassetid://4483345998",
                    Time = 3
                })
            end
        end    
    })
    
    TeleportTab:AddButton({
        Name = "Teleport to Dock",
        Callback = function()
            -- Try to find the dock in workspace
            local dockFound = false
            for _, obj in pairs(workspace:GetDescendants()) do
                if (obj.Name:lower():find("dock") or obj.Name:lower():find("pier")) and 
                   (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                    
                    if obj:IsA("BasePart") then
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                    else
                        Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                    end
                    
                    dockFound = true
                    OrionLib:MakeNotification({
                        Name = "Teleported",
                        Content = "Successfully teleported to Dock",
                        Image = "rbxassetid://4483345998",
                        Time = 3
                    })
                    break
                end
            end
            
            if not dockFound then
                OrionLib:MakeNotification({
                    Name = "Teleport Failed",
                    Content = "Could not find Dock",
                    Image = "rbxassetid://4483345998",
                    Time = 3
                })
            end
        end    
    })
    
    -- Settings tab
    SettingsTab:AddToggle({
        Name = "Anti-AFK",
        Default = true,
        Callback = function(Value)
            -- Anti-AFK is already setup at the beginning, this is just to show it in the UI
        end    
    })
    
    SettingsTab:AddButton({
        Name = "Copy Discord Invite",
        Callback = function()
            setclipboard("https://discord.gg/ugyvkJXhFh")
            OrionLib:MakeNotification({
                Name = "Discord Invite Copied",
                Content = "Discord invite link has been copied to clipboard",
                Image = "rbxassetid://4483345998",
                Time = 3
            })
        end    
    })
    
    SettingsTab:AddButton({
        Name = "Destroy GUI",
        Callback = function()
            autoFishingSettings.enabled = false
            globalEnv.SkyXFishingScriptLoaded = false
            
            OrionLib:Destroy()
        end    
    })
    
    -- Initial notification
    OrionLib:MakeNotification({
        Name = "SkyX Hub Loaded",
        Content = "Fishing Script loaded successfully!",
        Image = "rbxassetid://4483345998",
        Time = 5
    })
elseif globalEnv.SkyXUIMode == "Kavo" then
    -- Use Kavo UI Library
    local KavoLibrary = result
    
    local Window = KavoLibrary.CreateLib("SkyX Hub | Fishing Simulator", "Ocean")
    
    -- Main Page
    local MainPage = Window:NewTab("Auto Fish")
    local MainSection = MainPage:NewSection("Fishing")
    
    MainSection:NewToggle("Auto Fishing", "Auto fishes for you", function(state)
        autoFishingSettings.enabled = state
        
        if state then
            -- Start auto fishing loop
            startAutoFishing()
        end
    end)
    
    MainSection:NewDropdown("Minimum Rarity", "Sets minimum fish rarity", {"Trash", "Common", "Uncommon", "Unusual", "Rare", "Legendary", "Mythical", "Secret"}, function(currentOption)
        autoFishingSettings.minRarity = currentOption
    end)
    
    MainSection:NewToggle("Auto Sell", "Automatically sells fish", function(state)
        autoFishingSettings.autoSell = state
    end)
    
    MainSection:NewToggle("Keep Legendary+", "Keep rare fish", function(state)
        autoFishingSettings.keepLegendaryPlus = state
    end)
    
    MainSection:NewButton("Sell Fish Now", "Sells all your fish", function()
        sellFish()
    end)
    
    -- Teleport Page
    local TeleportPage = Window:NewTab("Teleport")
    local TeleportSection = TeleportPage:NewSection("Locations")
    
    TeleportSection:NewButton("Teleport to Shop", "Teleports to the shop", function()
        for _, obj in pairs(workspace:GetDescendants()) do
            if (obj.Name:lower():find("shop") or obj.Name:lower():find("store")) and 
               (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                
                if obj:IsA("BasePart") then
                    Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                else
                    Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                end
                
                break
            end
        end
    end)
    
    TeleportSection:NewButton("Teleport to Sell", "Teleports to sell area", function()
        for _, obj in pairs(workspace:GetDescendants()) do
            if (obj.Name:lower():find("sell") or obj.Name:lower():find("cash")) and 
               (obj:IsA("BasePart") or (obj:IsA("Model") and obj.PrimaryPart)) then
                
                if obj:IsA("BasePart") then
                    Character:SetPrimaryPartCFrame(CFrame.new(obj.Position + Vector3.new(0, 5, 0)))
                else
                    Character:SetPrimaryPartCFrame(CFrame.new(obj.PrimaryPart.Position + Vector3.new(0, 5, 0)))
                end
                
                break
            end
        end
    end)
    
    -- Settings Page
    local SettingsPage = Window:NewTab("Settings")
    local SettingsSection = SettingsPage:NewSection("Settings")
    
    SettingsSection:NewToggle("Anti-AFK", "Prevents you from being kicked", function(state)
        -- Anti-AFK is already setup
    end)
    
    SettingsSection:NewButton("Copy Discord", "Copies Discord invite", function()
        setclipboard("https://discord.gg/ugyvkJXhFh")
    end)
    
    SettingsSection:NewButton("Destroy GUI", "Closes the GUI", function()
        autoFishingSettings.enabled = false
        globalEnv.SkyXFishingScriptLoaded = false
        
        KavoLibrary:ToggleUI()
    end)
    
    -- Initial notification
    createNotification("SkyX Fishing", "Script loaded successfully!", 5)
end

-- Return the configuration for external access
return autoFishingSettings
